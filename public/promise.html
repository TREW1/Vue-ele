<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
</head>
<body>
    <h1>promise</h1>
    <script>
        //ES6
        // let promise = new Promise((resolve, reject)=>{
        //     //业务旅程  -->ajax
        //     reject(2222)
        // }) 
        // promise.then(res=>{
        //     console.log(res)
        // }).catch(err=>{
        //     console.log(err)
        // })
        //列式调用
        const fun1 = (flag)=>{
            new Promise((resolve,reject)=>{
                //业务流程  -->ajax
                if(flag){
                    console.log('第一个promise成功')
                    resolve('第一个成功数据')
                }else{
                    console.log('第一个promise失败')
                    reject('第一个失败数据')
                }
            })
        }
        const fun2 = (flag)=>{
            new Promise((resolve,reject)=>{
                //业务流程  -->ajax
                if(flag){
                    console.log('第二个promise成功')
                    resolve('第二个成功数据')
                }else{
                    console.log('第二个promise失败')
                    reject('第二个失败数据')
                }
            })
        }
        const fun3 = (flag)=>{
            new Promise((resolve,reject)=>{
                //业务流程  -->ajax
                if(flag){
                    console.log('第三个promise成功')
                    resolve('第三个成功数据')
                }else{
                    console.log('第三个promise失败')
                    reject('第三个失败数据')
                }
            })
        }
        const fun4 = (flag)=>{
            new Promise((resolve,reject)=>{
                //业务流程  -->ajax
                if(flag){
                    console.log('第四个promise成功')
                    resolve('第四个成功数据')
                }else{
                    console.log('第四个promise失败')
                    reject('第四个失败数据')
                }
            })
        }
    //    fun1(true).then (res=>{
    //        console.log(res)
    //        fun2(true)
    //     }).then(res=>{
    //         console.log(res)
    //         return fun3(true)
    //     }).then(res=>{
    //         console.log(res)
    //     })
    //     .then(err=>{
    //         console.log('xxxx')
    //         console.log(err)
    //     })

        // all : 多个promise执行 必须全部成功才能执行then 只要有一个失败就是catch
        Promise.all([fun1(true),fun2(true),fun3(true)]).then(res=>{
            console.log('xxx')
        }).catch(err=>{
            console.log('0000')
        })
        //race 只有一个成功，就执行then
        Promise.all([fun1(false),fun2(false),fun3(true)]).then(res=>{
            console.log('xxx')
        }).catch(err=>{
            console.log('0000')
        })
    </script>
</body>
</html>